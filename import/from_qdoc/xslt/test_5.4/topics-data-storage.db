<?xml version="1.0" encoding="UTF-8"?>
<db:article xmlns:db="http://docbook.org/ns/docbook"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            version="5.1"
            xml:lang="en">
   <db:title>Data Storage</db:title>
   <db:section xml:id="saving-and-loading-data">
      <db:title>Saving and Loading Data</db:title>
      <db:para>The <db:code><db:link xlink:href="qiodevice.db">QIODevice</db:link></db:code> class is the base class for all file and data storage devices in <db:link xlink:href="qtcore-index.db">Qt Core</db:link>. All classes that are used for reading and writing data inherit from it.</db:para>
      <db:para>Examples of devices are <db:code><db:link xlink:href="qfile.db">QFile</db:link></db:code>, <db:code><db:link xlink:href="qbuffer.db">QBuffer</db:link></db:code>, <db:code><db:link xlink:href="qtcpsocket.db">QTcpSocket</db:link></db:code>, and <db:code><db:link xlink:href="qprocess.db">QProcess</db:link></db:code>. <db:code><db:link xlink:href="qfile.db">QFile</db:link></db:code> is used for reading and writing text, binary files, and resources. The <db:code><db:link xlink:href="qbuffer.db">QBuffer</db:link></db:code> class provides a <db:code><db:link xlink:href="qiodevice.db">QIODevice</db:link></db:code> interface for a <db:code><db:link xlink:href="qbytearray.db">QByteArray</db:link></db:code>. <db:code><db:link xlink:href="qtcpsocket.db">QTcpSocket</db:link></db:code> enables the developer to establish a TCP connection and transfer streams of data. <db:code><db:link xlink:href="qprocess.db">QProcess</db:link></db:code> is used to start external programs, and to read from and write to that process.</db:para>
      <db:itemizedlist>
         <db:listitem>
            <db:para>
               <db:link xlink:href="io.db">Input/Output and Networking</db:link> (list of I/O related classes)</db:para>
         </db:listitem>
         <db:listitem>
            <db:para>
               <db:link xlink:href="io-functions.db">File and Datastream Functions</db:link>
            </db:para>
         </db:listitem>
         <db:listitem>
            <db:para>
               <db:link xlink:href="datastreamformat.db">Serializing Qt Data Types</db:link>
            </db:para>
         </db:listitem>
      </db:itemizedlist>
   </db:section>
   <db:section xml:id="sql-support-in-qt">
      <db:title>SQL Support in Qt</db:title>
      <db:para>The <db:link xlink:href="qtsql-index.db">Qt SQL</db:link> module uses driver plugins to communicate with several database APIs. Qt has drivers for SQLite, MySQL, DB2, Borland InterBase, Oracle, ODBC, and PostgreSQL. It is also possible to develop your own driver if Qt does not provide the driver needed.</db:para>
      <db:para>Qt's SQL classes can be divided in 3 layers:</db:para>
      <db:informaltable>
         <db:thead>
            <db:tr>
               <db:th>
                  <db:para>Layer</db:para>
               </db:th>
               <db:th>
                  <db:para>Purpose</db:para>
               </db:th>
               <db:th>
                  <db:para>Example class</db:para>
               </db:th>
            </db:tr>
         </db:thead>
         <db:tbody>
            <db:tr>
               <db:td>
                  <db:itemizedlist>
                     <db:listitem>
                        <db:para>Driver layer</db:para>
                     </db:listitem>
                     <db:listitem>
                        <db:para>SQL API layer</db:para>
                     </db:listitem>
                     <db:listitem>
                        <db:para>User Interface layer</db:para>
                     </db:listitem>
                  </db:itemizedlist>
               </db:td>
               <db:td>
                  <db:itemizedlist>
                     <db:listitem>
                        <db:para>Low-level communication between database and the SQL API layer</db:para>
                     </db:listitem>
                     <db:listitem>
                        <db:para>Provide access to databases</db:para>
                     </db:listitem>
                     <db:listitem>
                        <db:para>Link data from a database to data-aware widgets</db:para>
                     </db:listitem>
                  </db:itemizedlist>
               </db:td>
               <db:td>
                  <db:itemizedlist>
                     <db:listitem>
                        <db:para>
                           <db:code><db:link xlink:href="qsqldriver.db">QSqlDriver</db:link></db:code>, <db:code><db:link xlink:href="qsqldrivercreator.db">QSqlDriverCreator</db:link></db:code>
                        </db:para>
                     </db:listitem>
                     <db:listitem>
                        <db:para>
                           <db:code><db:link xlink:href="qsqldatabase.db">QSqlDatabase</db:link></db:code>, <db:code><db:link xlink:href="qsqlquery.db">QSqlQuery</db:link></db:code>
                        </db:para>
                     </db:listitem>
                     <db:listitem>
                        <db:para>
                           <db:code><db:link xlink:href="qsqlquerymodel.db">QSqlQueryModel</db:link></db:code> (readonly), <db:code><db:link xlink:href="qsqltablemodel.db">QSqlTableModel</db:link></db:code> (read/write), <db:code><db:link xlink:href="qsqlrelationaltablemodel.db">QSqlRelationalTableModel</db:link></db:code> (read/write with foreign-key support)</db:para>
                     </db:listitem>
                  </db:itemizedlist>
               </db:td>
            </db:tr>
         </db:tbody>
      </db:informaltable>
      <db:para>With the MySQL driver, it is possible to connect to a MySQL server. In order to build the QMYSQL Plugin for Unix or OS X, you need the MySQL header files as well as the shared library, libmysqlclient.so. To compile the plugin for Windows, install MySQL.</db:para>
      <db:para>If you use the embedded MySQL Server, you do not need a MySQL server in order to use that database system. In order to do so, you need to link the Qt plugin to libmysqld instead of libmysqlclient.</db:para>
      <db:para>The Qt SQLite plugin is very suitable for local storage. SQLite is a relational database management system contained in a small (~350 KiB) C library. In contrast to other database management systems, SQLite is not a separate process that is accessed from the client application, but an integral part of it. SQLite operates on a single file, which must be set as the database name when opening a connection. If the file does not exist, SQLite will try to create it.</db:para>
      <db:para>SQLite has some restrictions regarding multiple users and multiple transactions. If you are reading or writing on a file from different transactions, your application might freeze until one transaction commits or rolls back.</db:para>
      <db:para>Once the driver part is set up, the data is accessible using the classes, <db:code><db:link xlink:href="qsqlquerymodel.db">QSqlQueryModel</db:link></db:code>, <db:code><db:link xlink:href="qsqltablemodel.db">QSqlTableModel</db:link></db:code>, and <db:code><db:link xlink:href="qsqlrelationaltablemodel.db">QSqlRelationalTableModel</db:link></db:code>. <db:code><db:link xlink:href="qsqltablemodel.db">QSqlTableModel</db:link></db:code> and <db:code><db:link xlink:href="qsqlrelationaltablemodel.db">QSqlRelationalTableModel</db:link></db:code> provide editable models that can used with Qt's item views. <db:code><db:link xlink:href="qsqltablemodel.db">QSqlTableModel</db:link></db:code> has read/write access to a single table, whereas <db:code><db:link xlink:href="qsqlrelationaltablemodel.db">QSqlRelationalTableModel</db:link></db:code> has read/write access to the main table (not to the table with the foreign key).</db:para>
      <db:para>The following pages contain information about incorporating SQL into applications:</db:para>
      <db:itemizedlist>
         <db:listitem>
            <db:para>
               <db:link xlink:href="sql-programming.db">SQL Programming</db:link>
               <db:itemizedlist>
                  <db:listitem>
                     <db:para>
                        <db:link xlink:href="sql-programming.db#database-classes">Database Classes</db:link>
                     </db:para>
                  </db:listitem>
                  <db:listitem>
                     <db:para>
                        <db:link xlink:href="sql-sqlstatements.db">Executing SQL Statements</db:link>
                     </db:para>
                  </db:listitem>
                  <db:listitem>
                     <db:para>
                        <db:link xlink:href="sql-model.db">Using the SQL Model Classes</db:link>
                     </db:para>
                  </db:listitem>
                  <db:listitem>
                     <db:para>
                        <db:link xlink:href="sql-presenting.db">Presenting Data in a Table View</db:link>
                     </db:para>
                  </db:listitem>
                  <db:listitem>
                     <db:para>
                        <db:link xlink:href="sql-forms.db">Creating Data-Aware Forms</db:link>
                     </db:para>
                  </db:listitem>
               </db:itemizedlist>
            </db:para>
         </db:listitem>
      </db:itemizedlist>
   </db:section>
   <db:section xml:id="xml-support-in-qt">
      <db:title>XML Support in Qt</db:title>
      <db:para>Qt provides APIs to read and parse XML streams, and also to write to these streams. The following key classes facilitate these actions by providing the necessary infrastructure:</db:para>
      <db:itemizedlist>
         <db:listitem>
            <db:para>
               <db:code><db:link xlink:href=".dbstreamreader.db">QXmlStreamReader</db:link></db:code> class provides a parser to read XML. It is a well-formed XML 1.0 parser that does not include external parsed entities.<db:itemizedlist>
                  <db:listitem>
                     <db:para>It understands and resolves XML namespaces. For example, in case of a StartElement, namespaceUri() returns the namespace the element is in, and name() returns the element's local name. The combination of namespaceUri() and name() uniquely identifies an element.</db:para>
                  </db:listitem>
                  <db:listitem>
                     <db:para>It is not CPU-intensive, as it doesn't store the entire XML document tree in memory. It only stores the current token at the time it is reported.</db:para>
                  </db:listitem>
               </db:itemizedlist>
            </db:para>
         </db:listitem>
         <db:listitem>
            <db:para>The <db:code><db:link xlink:href=".dbstreamwriter.db">QXmlStreamWriter</db:link></db:code> class provides an XML writer with a simple streaming API. It is the counterpart to <db:code><db:link xlink:href=".dbstreamreader.db">QXmlStreamReader</db:link></db:code> for writing XML, and it operates on a <db:code><db:link xlink:href="qiodevice.db">QIODevice</db:link></db:code> specified with setDevice().<db:itemizedlist>
                  <db:listitem>
                     <db:para>It is a simple API that provides a dedicated function for every XML token or event you want to write.</db:para>
                  </db:listitem>
                  <db:listitem>
                     <db:para>It takes care of prefixing namespaces based on the namespaceUri specified while writing elements or attributes. If you have to use certain standardized prefixes, you can force the writer to use them by declaring the namespaces manually with either writeNamespace() or writeDefaultNamespace().</db:para>
                  </db:listitem>
                  <db:listitem>
                     <db:para>It can automatically format the generated XML data by adding line-breaks and indentation, making it readable. This feature can be turned on with the auto-formatting property.</db:para>
                  </db:listitem>
                  <db:listitem>
                     <db:para>It encodes XML in UTF-8 by default. Different encodings can be enforced using setCodec().</db:para>
                  </db:listitem>
               </db:itemizedlist>
            </db:para>
         </db:listitem>
      </db:itemizedlist>
      <db:para>Besides reading and writing to XML streams, Qt also provides APIs for the following additional use cases:</db:para>
      <db:itemizedlist>
         <db:listitem>
            <db:para>Querying an XML data source using <db:link xlink:href="xmlprocessing.db">XQuery</db:link> and XPath</db:para>
         </db:listitem>
         <db:listitem>
            <db:para>XML transformation using XSLT</db:para>
         </db:listitem>
         <db:listitem>
            <db:para>XML schema validation</db:para>
         </db:listitem>
      </db:itemizedlist>
      <db:para>The following topics provide more insight into Qt XML support:</db:para>
      <db:itemizedlist>
         <db:listitem>
            <db:para>
               <db:link xlink:href="xml-namespaces.db">An Introduction to Namespaces</db:link>
            </db:para>
         </db:listitem>
         <db:listitem>
            <db:para>
               <db:link xlink:href="xml-streaming.db">XML Streaming</db:link>
            </db:para>
         </db:listitem>
         <db:listitem>
            <db:para>
               <db:link xlink:href="xquery-introduction.db">A Short Path to XQuery</db:link>
            </db:para>
         </db:listitem>
         <db:listitem>
            <db:para>
               <db:link xlink:href="qtquick-modelviewsdata-modelview.db.dblistmodel">XmlListModel</db:link>
            </db:para>
         </db:listitem>
         <db:listitem>
            <db:para>
               <db:link xlink:href="q.dbpatterns-index.db">Qt XML Patterns</db:link>
            </db:para>
         </db:listitem>
      </db:itemizedlist>
   </db:section>
   <db:section xml:id="json-in-qt">
      <db:title>JSON in Qt</db:title>
      <db:para>JSON is a text-based open standard for data interchange that is easy to read and parse. It is used for representing simple data structures and associative arrays, called objects. It is related to JavaScript, but is a language-independent notation form.</db:para>
      <db:para>An object can take 2 forms:</db:para>
      <db:itemizedlist>
         <db:listitem>
            <db:para>Collection of name/value pairs</db:para>
         </db:listitem>
         <db:listitem>
            <db:para>Ordered list of values</db:para>
         </db:listitem>
      </db:itemizedlist>
      <db:informaltable>
         <db:tbody>
            <db:tr>
               <db:td>
                  <db:itemizedlist>
                     <db:listitem>
                        <db:para>{ "last_name": "Routledge", "first_name": "Ronald", "birth_date": 1960 }</db:para>
                     </db:listitem>
                     <db:listitem>
                        <db:para>"colours": ["green", "blue", "yellow"]</db:para>
                     </db:listitem>
                  </db:itemizedlist>
               </db:td>
               <db:td>
                  <db:para/>
               </db:td>
            </db:tr>
         </db:tbody>
      </db:informaltable>
      <db:itemizedlist>
         <db:listitem>
            <db:para>
               <db:link xlink:href="json.db">JSON Support in Qt</db:link>
            </db:para>
         </db:listitem>
         <db:listitem>
            <db:para>
               <db:link xlink:href="qtcore-json-savegame-example.db">JSON Save Game Example</db:link>
            </db:para>
         </db:listitem>
      </db:itemizedlist>
   </db:section>
   <db:section xml:id="local-storage">
      <db:title>Local Storage</db:title>
      <db:para>The Local Storage API provides the ability to access local offline storage in an SQL database from QML and JavaScript.</db:para>
      <db:para>These databases are user-specific and QML-specific, but accessible to all QML applications. They are stored in the Databases subdirectory of QDeclarativeEngine::offlineStoragePath() as SQLite databases (<db:link xlink:href="sql-driver.db">SQL Database Drivers</db:link>).</db:para>
      <db:para>The API conforms to the Synchronous API of the HTML5 Web Database API, W3C Working Draft 29 October 2009 (<db:link xlink:href="http://www.w3.org/TR/2009/WD-webdatabase-20091029/">HTML5 Web Database API</db:link>).</db:para>
      <db:para>See <db:link xlink:href="qtquick-localstorage-example.db">Qt Quick Examples - Local Storage</db:link> for a basic demonstration of using the Local Storage API.</db:para>
      <db:itemizedlist>
         <db:listitem>
            <db:para>
               <db:link xlink:href="qtquick-localstorage-qmlmodule.db">Qt Quick Local Storage QML Types</db:link>
            </db:para>
         </db:listitem>
      </db:itemizedlist>
   </db:section>
   <db:section xml:id="qsettings-class">
      <db:title>QSettings Class</db:title>
      <db:para>The <db:code><db:link xlink:href="qsettings.db">QSettings</db:link></db:code> class provides persistent storage of application settings. An application usually remembers its settings from the previous session.</db:para>
      <db:para>Settings are stored differently on different platforms. For example, on Windows they are stored in the registry, whereas, on MAC OS X they are stored in XML files.</db:para>
      <db:para>
         <db:code><db:link xlink:href="qsettings.db">QSettings</db:link></db:code> enable you to save and restore application settings in a portable manner. Constructing and destroying a <db:code><db:link xlink:href="qsettings.db">QSettings</db:link></db:code> object is lightweight and fast. While creating an object of <db:code><db:link xlink:href="qsettings.db">QSettings</db:link></db:code>, it is a good practice to specify not only the name of the application, but also the name of your organization. For example:</db:para>
      <db:programlisting>QSettings settings("MyCompany","Accountancy");</db:programlisting>
   </db:section>
   <db:section xml:id="resources">
      <db:title>Resources</db:title>
      <db:para>The Qt Resource System is a platform-independent mechanism for storing binary files in the application's executable. This is handy if your application frequently needs a certain file, or set of files. It also protects against loss of that particular file .</db:para>
      <db:para>Resource data can either be compiled into the binary and accessed immediately in the application code, or a binary resource can be created dynamically and registered with the resource system by the application.</db:para>
      <db:para>By default, resources are accessible from the application code by the same file name as they are stored in the source tree, with a <db:code>:/</db:code> prefix, or by a URL with a qrc scheme.</db:para>
      <db:itemizedlist>
         <db:listitem>
            <db:para>
               <db:link xlink:href="resources.db">The Qt Resource System</db:link>
            </db:para>
         </db:listitem>
      </db:itemizedlist>
   </db:section>
   <db:section xml:id="file-archiving">
      <db:title>File Archiving</db:title>
      <db:para>An archive file is a collection of files or directories which are generally compressed in order to reduce the space they would otherwise consume on a drive. Examples of archive files are ZIP, TAR, RAR and 7z.</db:para>
      <db:para>Qt has support for archives produced by zlib (see <db:link xlink:href="http://qt-project.org/faq/answer/how_to_compress_data_with_qt">qCompress() and qUncompress()</db:link>).</db:para>
   </db:section>
   <db:section xml:id="enginio-data-storage-backend">
      <db:title>Enginio Data Storage Backend</db:title>
      <db:para>Enginio is a backend for Qt Cloud services. New in Qt 5.3, the Enginio mondule combines a <db:emphasis>no-SQL</db:emphasis> object approach with JSON and Qt APIs to provide applications a reliable and powerful storage capability. The C++ and QML APIs interact with the <db:link xlink:href="https://qtcloudservices.com/">Qt Cloud</db:link> servers from Digia.</db:para>
      <db:itemizedlist>
         <db:listitem>
            <db:para>
               <db:link xlink:href="https://qtcloudservices.com/">Qt Cloud Services</db:link> by Digia</db:para>
         </db:listitem>
         <db:listitem>
            <db:para>Enginio - API for developers</db:para>
         </db:listitem>
      </db:itemizedlist>
   </db:section>
</db:article>
